# Conversation Pipeline JSON Schema

This document describes the keys and values expected in the structured JSON output of your LLM assistant. Use this schema to validate and parse responses.

## Core Response Fields

| Key             | Type                         | Description                                                                                             |
|-----------------|------------------------------|---------------------------------------------------------------------------------------------------------|
| schema_version  | str                          | Version of the JSON schema (e.g., "1.0").                                                               |
| status          | "ok" \| "error"             | Indicates success ("ok") or failure ("error") of the response.                                         |
| messages        | List[Message]                | Array of message objects representing conversation turns.                                               |

### Message Object

| Key       | Type                             | Description                                                |
|-----------|----------------------------------|------------------------------------------------------------|
| turn_id   | int                              | Monotonic ID of the message.                              |
| role      | "system"\|"user"\|"assistant"    | The speaker of the message.                               |
| content   | str                              | The text content of the message.                          |
| timestamp | float                            | Unix epoch time (seconds) when the message was generated. |

## Intent & Entities

| Key      | Type           | Description                                                     |
|----------|----------------|-----------------------------------------------------------------|
| intent   | Optional[str]  | High-level intent label indicating the purpose of the response.|
| entities | Optional[Dict] | Key-value pairs of extracted entities or slots.                |

## Agentic Actions

| Key         | Type           | Description                                                          |
|-------------|----------------|----------------------------------------------------------------------|
| next_action | NextAction     | Action to be performed, with name and arguments.                     |

### NextAction Object

| Key   | Type               | Description                                        |
|-------|--------------------|----------------------------------------------------|
| name  | str                | Name of the action (e.g., "schedule_reminder").    |
| args  | Dict[str, str]     | Parameters for the action.                         |

## Memory Signals

| Key           | Type           | Description                                      |
|---------------|----------------|--------------------------------------------------|
| memory_read   | List[str]      | Past memory snippets used in generating response.|
| memory_write  | List[str]      | New facts or preferences to store.               |

## Retrieval Metadata

| Key       | Type           | Description                                                     |
|-----------|----------------|-----------------------------------------------------------------|
| retrieval | Retrieval      | Details of any memory or knowledge retrieval performed.         |

### Retrieval Object

| Key     | Type          | Description                                    |
|---------|---------------|------------------------------------------------|
| method  | str           | Retrieval method (e.g., "semantic", "keyword").|
| query   | str           | The query text used for retrieval.             |
| results | List[Result]  | Retrieved snippets with scores.                |

#### Result Object

| Key   | Type    | Description                          |
|-------|---------|--------------------------------------|
| text  | str     | Retrieved snippet text.              |
| score | float   | Similarity or relevance score.       |

## Warnings

| Key       | Type       | Description                                       |
|-----------|------------|---------------------------------------------------|
| warnings  | List[str]  | Non-critical warnings generated by the assistant. |

---

Use this README to guide your prompt and to validate the LLM's JSON output schema.
